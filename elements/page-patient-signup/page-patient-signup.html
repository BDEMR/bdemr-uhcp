<!-- iron-* --><!-- paper-* --><!-- style --><!-- behavior --><!-- custom-elements --><!-- element --><dom-module id="page-patient-signup">
  <template>

    <!-- style -->

    <style is="custom-style" include="common-style">

      paper-card {
        border-radius: 6px;
        text-align: left !important;
        background-color: #fff;
      }

      paper-card ::content .header {
        border: none;
      }

      /*paper-card ::content .card-content {
        padding: 40px 16px;
      }*/

      paper-button {
        text-transform: capitalize;
      }

      paper-button.btn.text-success {
        color: rgb(47, 127, 50) !important;
      }
      paper-button.btn.text-info {
        color: var(--paper-blue-700) !important;
      }

      paper-button.btn.text-warning {
        color: var(--paper-orange-900) !important;
      }

      .btn.success {
        background-color: var(--paper-green-700);
        color: #fff;
      }

      .p-horizontal-16 {
        padding-left: 16px;
        padding-right: 16px;
      }

      .p-horizontal-8 {
        padding-left: 8px;
        padding-right: 8px;
      }

      .m-0 {
        margin: 0 !important;
      }

      .m-top-40 {
        margin-top: 40px;
      }

      .m-top-24 {
        margin-top: 24px;
      }

      .m-top-16 {
        margin-top: 16px;
      }

      .m-top-8 {
        margin-top: 8px;
      }

      .m-right-16 {
        margin-right: 16px;
      }

      /*.card {
        width: 370px;
      }*/

      paper-button.btn.medium {
        font-size: 14px;
      }
      .user-avatar {
        height: 64px;
        width: 64px;
        border-radius: 50%;
      }

      .user-avatar.small {
        height: 36px;
        width: 36px;
      }

      .user-avatar.medium {
        height: inherit;
        width: inherit;
      }

      .type-content paper-button {
        margin: 8px;
        width: calc(50% - 18px);
      }

      .user-info {
        background-color: #f7f7f7;
        padding: 16px 24px !important;
      }
      iron-icon.icon.small {
        height: 16px;
        width: 16px;
      }

      .m-right-4 {
        margin-right: 4px;
      }

      .image.normal-size {
        height: 64px;
        width: 64px;
      }

      .image.mid-size {
        height: 48px;
        width: 48px;
      }

      .shadow-2 {
        box-shadow: var(--shadow-elevation-2dp_-_box-shadow);
      }

      .content {
        /*padding: 8px;*/
      }


      .content.left {
        width: calc(40%);
      }

      .content.right {
        width: calc(60%);
      }

      .custom-input {
        width: calc(100% - 26px);
      }

      @media screen and (min-width: 656px) {
        .custom-input {
          width: calc(50% - 26px);
        }
      }

      @media screen and (min-width: 976px) {
        .custom-input {
          width: calc(33.33333% - 26px);
        }
      }

      .paper-custom {
        background-color: #fff;
        border: 1px solid #dadada;
        border-radius: 6px;
        padding: 0px 8px 12px 8px;
        margin: 8px;
        min-width: calc(100% - 26px);
      }



      @media screen and (min-width: 656px) {
        .paper-custom {
          min-width: calc(50% - 26px);
        }
        .paper-custom.full {
          min-width: calc(100% - 26px);
        }
      }

      @media screen and (min-width: 976px) {
        .paper-custom {
          min-width: calc(33.33333% - 26px);
        }
        .paper-custom.full {
          min-width: calc(100% - 26px);
        }
      }

      .custom-label-2 {
        background-color: #fafafa;
        padding: 6px 12px;
        margin: 8px;
        width: calc(100% - 36px);
        border-radius: 6px;
        border: 2px solid #eee;
      }

      .custom-label-2 .type {
        font-weight: 500 !important;
      }

      .custom-label-2.normal {
        border-color: #43A047;
        color: #43A047 !important;
      }

      .custom-label-2.warning {
        border-color: #E65100;
        color: #E65100 !important;
      }

      .custom-label-2.danger {
        border-color: #E53935;
        color: #E53935 !important;
      }

      @media screen and (min-width: 656px) {
        .custom-label-2 {
          width: calc(50% - 36px);
        }
      }

      @media screen and (min-width: 976px) {
        .custom-label-2 {
          width: calc(33.33333% - 36px);
        }
      }

      .custom-radio-button-group.full-width {
        width: calc(100% - 26px) !important;
      }

      .custom-label.full-width {
        width: calc(100% - 26px) !important;
      }


      .custom-radio-button-group,
      .custom-label {
        background-color: #fff;
        border: 1px solid #dadada;
        border-radius: 6px;
        padding: 8px;
        margin: 8px;
        width: calc(100% - 26px);
      }

      @media screen and (min-width: 656px) {
        .custom-radio-button-group,
        .custom-label {
          width: calc(50% - 26px);
        }
      }

      @media screen and (min-width: 976px) {
        .custom-radio-button-group,
        .custom-label {
          width: calc(33.33333% - 26px);
        }
      }

      .profile-image-area {
        position: relative;
        height: 128px;
        width: 128px;
        margin-top: 33px;
      }

      #fileInput {
        position: absolute;
        height: 100%;
        width: 100%;
        left: 0;
        top: 0;
        cursor: pointer;
        opacity: 0;
      }

      #fileInput:hover {
        background-color: rgba(0,0,0, .56)
      }

      .p-horizontal-40 {
        padding-left: 40px;
        padding-right: 40px;
      }
    </style>

    <!-- local DOM -->
    <div class="master-container">
      <div class="limiting-container">

        <paper-card class="card">

         
          
          <div class="card-content">
            <iron-image class="p-horizontal-8" src="../../images/bdemr_logo_small.png" preload=""></iron-image>
            <div class="type headline p-horizontal-8">Patient Signup</div>
          </div>

          <iron-pages selected="{{selectedPage}}">

            <!-- step 1 - start  -->
            <section>
              <div class="card-content horizontal layout">
                <div class="content left">
                  <div class="custom-label full-width" style="background-color: #f7f7f7;">

                    <div class="horizontal layout center-justified center">
                      <div class="profile-image-area">
                        <iron-image class="user-avatar medium" src$="[[profileImage]]" preload="" sizing="cover"></iron-image>
                        <input id="fileInput" type="file" accept="image/*" on-change="fileInputChanged">
                      </div>
                    </div>
                    <div class="type caption text-center secondary m-top-8 p-horizontal-8 center horizontal layout">
                      <!-- <iron-icon icon="icons:lightbulb-outline" class="icon small m-right-4"></iron-icon> -->
                      <div class="flex">we recommend you to add your profile photo so that your doctor/service provider can identify you better.</div>
                    </div>

                    <paper-input class="p-horizontal-8 m-top-16" label="NID/Birth Certificate Number" required="" min="10" max="17"></paper-input>
                    <div class="type caption secondary p-horizontal-8 horizontal layout center">
                      <!-- <iron-icon icon="icons:info-outline" class="icon small m-right-4"></iron-icon> -->
                      <div class="flex">you can add any old/newly issue NID card/Birth certificate number if you don't have any of those</div>
                    </div>
                  </div>
                </div>

                <div class="content right flex">
                  

                  <paper-input class="custom-input paper-custom full" label="Full Name" required="" value="{{patient.name}}" auto-validate="" error-message="Patient Name is Required!" on-keyup="checkNextBtnStatus"></paper-input>

                  <div class="custom-input paper-custom horizontal layout full">
                    <vaadin-date-picker on-keyup="checkNextBtnStatus" required="" auto-validate="" error-message="Date of Birth is Required!" class="flex m-right-16" type="date" value="{{patient.dateOfBirth}}" label="Date of Birth" on-value-changed="calculateAge"></vaadin-date-picker>

                    <paper-input label="Age" type="number" value="{{ageInYears}}" on-change="makeDOBFromYears"></paper-input>
                  </div>
                  

                  <div class="custom-radio-button-group full-width">
                    
                    <div class="type body secondary">Gender</div>
                    <paper-radio-group selected="{{patient.gender}}">
                      <paper-radio-button name="male">Male</paper-radio-button>
                      <paper-radio-button name="female">Female</paper-radio-button>
                      <paper-radio-button name="other">Other</paper-radio-button>
                    </paper-radio-group>
                  </div>

                  <paper-input class="custom-input paper-custom full" value="{{patient.phone}}" label="Phone Number" pattern="^[0-9]{11,11}(-[0-9]*){0,1}$" required="" auto-validate="" error-message="Phone Number Required. i.e.: 01712345678 or 01712345678-12'" char-counter="" minlength="11" maxlength="14" on-keyup="_checkIfMobileNumberAvailable">
                    <div prefix="">+88</div>
                  </paper-input>

                  

                  <template is="dom-if" if="[[errorMsg]]">
                    <div class="p-top-8 type caption-2 danger p-horizontal-8 horizontal layout center">
                      <iron-icon icon="icons:info-outline" class="icon small m-right-4"></iron-icon>
                      <div class="flex">{{errorMsg}}</div>
                    </div>
                  </template>

                  <template is="dom-if" if="[[successMsg]]">
                    <div class="p-top-8 type caption-2 primary p-horizontal-8 horizontal layout center">
                      <iron-icon icon="icons:info-outline" class="icon small m-right-4"></iron-icon>
                      <div class="flex">{{successMsg}}</div>
                    </div>
                  </template>
                  


                  <div class="horizontal layout m-top-16 center">
                    <div class="flex"></div>
                    <!-- <paper-button disabled class$="p-horizontal-40 {{addClassOnNextBtn}}" raised auto-focuse on-tap="offlineSignup">Signup (offline)</paper-button> -->
                    <paper-button disabled="{{disableNextBtn}}" class$="p-horizontal-40 {{addClassOnNextBtn}}" raised="" auto-focuse="" on-tap="nextBtnPressed">Signup</paper-button>
                  </div>
                </div>
              </div>
            </section>
            <!-- step 1 - end  -->
            
            <!-- step 2 - start  -->
            <section>
              <div class="card-content">

                <div class="layout center">
                  <!-- <div class="type headline p-horizontal-8 m-top-24">Dear, John Doe</div> -->
                  <div class="type body-lead p-horizontal-8">we sent a verification code on patient phone number.</div>
                  <!-- <div class="type body secondary p-horizontal-8">please wait for <span>0:59s</span></div> -->
                  <!-- <div class="type headline p-horizontal-8">017123456789</div> -->
                </div>
                

                <paper-input class="p-horizontal-8" label="Verification Code" value="{{verifyPhoneNumber.typedSmsVerificationCode}}"></paper-input>

                <div class="horizontal layout m-top-24 center">
                  <div class="flex"></div>
                  <paper-button auto-focuse="" on-tap="" disabled="">Resend Code</paper-button>
                  <paper-button raised="" class="btn success p-horizontal-40" auto-focuse="" on-tap="verifyBtnPressed">Verify</paper-button>
                </div>

              </div>
              
            </section>
            <!-- step 2 - end  -->
          </iron-pages>


        </paper-card>

      </div>
    </div>

   

  </template>
  <script>(function(){Polymer({is:"page-patient-signup",behaviors:[app.behaviors.commonComputes,app.behaviors.dbUsing,app.behaviors.translating,app.behaviors.pageLike,app.behaviors.apiCalling],properties:{user:{type:Object,notify:!0,value:{}},organization:{type:Object,notify:!0,value:{}},patient:{type:Object,notify:!0,value:function(){return{}}},selectedPage:{type:Number,value:0},verifyPhoneNumber:{type:Object,notify:!0,value:function(){return{}}},ageInYears:{type:Number,value:-1},errorMsg:{type:String,notify:!0,value:null},successMsg:{type:String,notify:!0,value:null},maximumImageSizeAllowedInBytes:{type:Number,value:1e6},disableNextBtn:{type:Boolean,value:!0,notify:!0},addClassOnNextBtn:{type:String,value:"",notify:!0},isPhoneNumberAvailable:{type:Boolean,value:!1,notify:!0},profileImage:{type:String,value:null,notify:!0}},calculateAge:function(t){var e,i,n,a;return n=t.detail.value,a=new Date(n).getFullYear(),i=(new Date).getFullYear(),e=i-a,0===e&&(e=null),this.ageInYears=e},makeDOBFromYears:function(t){var e,i;return e=t.target.value,i=(new Date).getFullYear(),i-=parseInt(e),this.set("patient.dateOfBirth",i+"-01-01")},fileInputChanged:function(t){var e,i;return i=new FileReader,e=t.target.files[0],e.size>this.maximumImageSizeAllowedInBytes?void this.domHost.showModalDialog("Please provide a file less than 1mb in size."):(i.readAsDataURL(e),i.onload=function(t){return function(){var e;return e=i.result,t.set("profileImage",e),t.set("patient.profileImage",e)}}(this))},_mimicPatientImport:function(t,e){return t.flags={isImported:!1,isLocalOnly:!1,isOnlineOnly:!1},t.flags.isImported=!0,app.db.insert("patient-list",t),e()},_gotoPatientDetailsPage:function(t){return this.domHost.navigateToPage("#/patient-view/patient:"+t)},createdPatientVisitedLog:function(t){var e;return e={createdByUserSerial:this.user.serial,serial:this.generateSerialForVisitedPatientLog(),patientSerial:t.serial,patientName:t.name,visitedDateTimeStamp:lib.datetime.now(),lastModifiedDatetimeStamp:lib.datetime.now()},app.db.insert("visited-patient-log",e)},_importPatient:function(t,e,i){return this.callApi("/bdemr-patient-import-new",{serial:t,pin:e,doctorName:this.user.name,organizationId:this.organization.idOnServer},function(t){return function(e,n){var a,r,s;return n.hasError?t.domHost.showModalDialog(n.error.message):(s=n.data,1!==s.length?t.domHost.showModalDialog("Unknown error occurred."):(r=s[0],r.flags={isImported:!1,isLocalOnly:!1,isOnlineOnly:!1},r.flags.isImported=!0,t.removePatientIfAlreadyExist(r.serial),a=app.db.insert("patient-list",r),i(r)))}}(this))},removePatientIfAlreadyExist:function(t){var e,i;e=app.db.find("patient-list",function(e){var i;return i=e.serial,i===t}),1===e.length&&(i=e[0],app.db.remove("patient-list",i._id))},goPatientViewPage:function(t){return this.domHost.setCurrentPatientsDetails(t),this.createdPatientVisitedLog(t),this.domHost.navigateToPage("#/patient-viewer/patient:"+t.serial+"/selected:5"),this.domHost.selectedPatientPageIndex=5},nextBtnPressed:function(){return this.patient.name&&this.patient.dateOfBirth&&this.patient.gender&&this.patient.phone?(this.patient.name=this.$makeNameObject(this.patient.name),this.patient.organizationId=this.organization.idOnServer,this._callBdemrAppPatientPartialSignupApi(this.patient,function(t){return function(e,i){return t._importPatient(e,i,function(n){return t._memorizePinForNewPatient(e,i),t.goPatientViewPage(n),t.domHost.showToast("Patient Created Successfully!")})}}(this))):void this.domHost.showToast("Please Fill Up Required Information")},_createTemporaryOfflinePatient:function(t,e){var i;return i=""+(new Date).getTime()+"-"+(Math.floor(1e4*Math.random())+1e4),t.serial=i,t.isTemporaryOfflinePatient=!0,lib.util.delay(0,function(i){return function(){return e(t)}}(this)),this._createTemporaryOfflinePatient(this.patient,function(t){return function(e){return t._memorizePinForNewPatient(e),t._mimicPatientImport(e),t.domHost.showModalDialog("Patient Created Successfully!")}}(this))},offlineSignup:function(){return this.patient.name&&this.patient.dateOfBirth&&this.patient.gender&&this.patient.phone?(this.patient.name=this.$makeNameObject(this.patient.name),this.patient.organizationId=this.organization.idOnServer,this.patient.doctorAccessPin=this.generateRandomNumericString(4)):void this.domHost.showToast("Please Fill Up Required Information")},verifyBtnPressed:function(){return this._callVerifyPatientPhoneNumber(this.verifyPhoneNumber,function(t){return function(){var e;return e=t.verifyPhoneNumber.patientId,t._callBdemrAppPatientCompleteSignupApi(e)}}(this))},_memorizePinForNewPatient:function(t,e){var i;return i={},i.organizationId=this.organization.idOnServer,i.patientSerial=t,i.pin=e,app.db.upsert("local-patient-pin-code-list",i,function(t){return function(t){var e;return e=t.patientSerial,i.patientSerial===e}}(this))},_callBdemrAppPatientPartialSignupApi:function(t,e){return t.apiKey=this.user.apiKey,this.callApi("/bdemr-app-patient-signup-partial",t,function(t){return function(i,n){var a,r,s;return n.hasError?t.domHost.showModalDialog(n.error.message):(r=n.data.patientId,a=n.data.doctorAccessPin,s=n.data.patientSerial,e(s,a))}}(this))},_checkIfMobileNumberAvailable:function(t){var e;if(null!==this.patient.phone)return e=this.patient.phone.length,11===e||13===e||14===e?this._callBdemrAppCheckUserProvidedPhoneNumber():(this.set("errorMsg",null),this.set("successMsg",null),this.checkNextBtnStatus(!0))},_callBdemrAppCheckUserProvidedPhoneNumber:function(){var t;return t={},t.phone=this.patient.phone,t.apiKey=this.user.apiKey,this.callApi("/bdemr-check-user-provided-phone-number",t,function(t){return function(e,i){return i.hasError||(i.data.isNumberInUse?(t.set("errorMsg",i.data.message),t.set("successMsg",null),t.set("isPhoneNumberAvailable",!1)):(t.set("errorMsg",null),t.set("successMsg",i.data.message),t.set("isPhoneNumberAvailable",!0))),t.checkNextBtnStatus()}}(this))},checkNextBtnStatus:function(){return this.patient.name&&this.patient.dateOfBirth&&this.patient.gender&&this.patient.phone?(this.isPhoneNumberAvailable?this.set("disableNextBtn",!1):this.set("disableNextBtn",!0),this.changeNextBtnClass(this.disableNextBtn)):(this.set("disableNextBtn",!0),void this.set("addClassOnNextBtn",""))},changeNextBtnClass:function(t){return t?this.set("addClassOnNextBtn",""):this.set("addClassOnNextBtn","btn success")},_callBdemrAppPatientCompleteSignupApi:function(t){var e;return e={},e.patientId=t,e.apiKey=this.user.apiKey,this.callApi("/bdemr-app-patient-signup-complete",e,function(t){return function(e,i){return i.hasError?t.domHost.showModalDialog(i.error.message):(t.domHost.showModalDialog("Patient Created Successfully!"),t.domHost.navigateToPage("#/patient-manager/query:"+t.patient.phone))}}(this))},_callVerifyPatientPhoneNumber:function(t,e){return t.apiKey=this.user.apiKey,this.callApi("/bdemr-verify-patient-phone-number",t,function(t){return function(i,n){return n.hasError?t.domHost.showModalDialog(n.error.message):e()}}(this))},_makePatientSignupObject:function(){return this.patient={name:null,phone:null,dateOfBirth:lib.datetime.mkDate(lib.datetime.now()),gender:"male",profileImage:null,nationalIdCardNumber:null,organizationId:null},this.verifyPhoneNumber={patientId:null,typedSmsVerificationCode:null}},navigatedIn:function(){return this.user=app.db.find("user")[0],this.set("selectedPage",0),this.set("profileImage","images/avatar.png"),this.organization=this.getCurrentOrganization(),this.organization||this.domHost.navigateToPage("#/select-organization"),this._makePatientSignupObject()},navigatedOut:function(){return this.patient=null,this.isPatientValid=!1,this.set("EDIT_MODE_ON",!1)}})}).call(this);
//# sourceMappingURL=page-patient-signup.coffee-compiled.js.map</script>
</dom-module>
