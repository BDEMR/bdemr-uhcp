{"version":3,"sources":["common-computes.coffee","common-computes.js"],"names":["slice","indexOf","item","i","l","this","length","app","behaviors","commonComputes","$equals","left","right","$if","value","thenValue","elseValue","$iff","$sum","a","b","$and","$truncate","string","maxCount","substr","$mkDate","date","lib","datetime","mkDate","$mkDateTime","ms","now","format","Date","$mkTime","$in","list","arguments","call","$returnSerial","index","$isEmptyArray","data","$getFullName","first","honorifics","last","middle","$makeNameObject","fullName","nameObject","namePart","partArray","trim","split","pop","join","shift","$getProfileImage","$checkUserAccess","accessId","currentOrganization","len","privilege","privilegeList","getCurrentOrganization","isCurrentUserAnAdmin","isCurrentUserAMember","userActiveRole","serial"],"mappings":"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","file":"common-computes.coffee-compiled.js","sourcesContent":["\napp.behaviors.commonComputes = \n\n  $equals: (left, right)-> left is right\n\n  $if: (value, thenValue, elseValue)-> if value then thenValue else elseValue\n\n  $iff: (value)-> value\n\n  $sum: (a,b)-> a + b\n\n  $and: (a,b)-> a and b\n\n  $truncate: (string, maxCount)->\n    return string if string.length <= maxCount\n    return (string.substr 0, (maxCount - 3)) + '...'\n\n  $mkDate: (date)-> lib.datetime.mkDate date\n\n  $mkDateTime: (ms)->\n    if typeof ms is 'undefined'\n      return lib.datetime.now()\n    else\n      return lib.datetime.format((new Date ms), 'mmm d, yyyy h:MMTT')\n\n  $mkTime: (ms)-> lib.datetime.format((new Date ms), 'HH-MM-ss')\n\n  $in: (item, list...)->\n    item in list\n\n  $returnSerial: (index)->\n    index+1\n\n  $isEmptyArray: (data)->\n    if data is 0\n      return true\n    else\n      return false\n\n  $getFullName:(data)->\n\n    if typeof data is \"object\"\n      honorifics = ''\n      first = ''\n      last = ''\n      middle = ''\n\n      if data.honorifics  \n        honorifics = data.honorifics + \". \"\n      if data.first\n        first = data.first\n      if data.middle\n        middle = \" \" + data.middle\n      if data.last\n        last = \" \" + data.last\n        \n      return honorifics + first + middle + last\n\n    else return data\n\n\n  $makeNameObject: (fullName)->\n\n    if typeof fullName is 'string'\n\n      fullName = fullName.trim()\n\n      partArray = fullName.split('.')\n\n      namePart = partArray.pop()\n\n      if partArray.length is 0 \n        honorifics = ''\n      else\n        honorifics = partArray.join('.').trim()\n\n      partArray = (namePart.trim()).split(' ')\n\n      nameObject = {}\n\n      if (partArray.length <= 1)\n        first = partArray[0]\n      else\n        first = partArray.shift()\n        last = partArray.pop()\n        middle = partArray.join(' ')\n\n        if middle is ''\n          middle = null\n        \n        if last is ''\n          last = null\n\n      if honorifics is ''\n        honorifics = null\n\n      nameObject.honorifics = honorifics\n      nameObject.first = first\n      nameObject.middle = middle\n      nameObject.last = last\n      return nameObject\n    else\n      return fullName\n\n\n  $getProfileImage: (data)->\n    if data\n      return data\n    else\n      return 'images/avatar.png'\n\n  $checkUserAccess: (accessId)->\n    currentOrganization = @getCurrentOrganization()\n\n    if accessId is 'none'\n      return true\n    else\n      if currentOrganization\n\n        if currentOrganization.isCurrentUserAnAdmin\n          return true\n        else if currentOrganization.isCurrentUserAMember\n          if currentOrganization.userActiveRole\n            privilegeList = currentOrganization.userActiveRole.privilegeList\n            unless privilegeList.length is 0\n              for privilege in privilegeList\n                if privilege.serial is accessId\n                  return true\n          else\n            return true\n\n          return false\n        else\n          return false\n\n      else\n        # @navigateToPage \"#/select-organization\"\n        return true\n      \n","(function() {\n  var slice = [].slice,\n    indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\n  app.behaviors.commonComputes = {\n    $equals: function(left, right) {\n      return left === right;\n    },\n    $if: function(value, thenValue, elseValue) {\n      if (value) {\n        return thenValue;\n      } else {\n        return elseValue;\n      }\n    },\n    $iff: function(value) {\n      return value;\n    },\n    $sum: function(a, b) {\n      return a + b;\n    },\n    $and: function(a, b) {\n      return a && b;\n    },\n    $truncate: function(string, maxCount) {\n      if (string.length <= maxCount) {\n        return string;\n      }\n      return (string.substr(0, maxCount - 3)) + '...';\n    },\n    $mkDate: function(date) {\n      return lib.datetime.mkDate(date);\n    },\n    $mkDateTime: function(ms) {\n      if (typeof ms === 'undefined') {\n        return lib.datetime.now();\n      } else {\n        return lib.datetime.format(new Date(ms), 'mmm d, yyyy h:MMTT');\n      }\n    },\n    $mkTime: function(ms) {\n      return lib.datetime.format(new Date(ms), 'HH-MM-ss');\n    },\n    $in: function() {\n      var item, list;\n      item = arguments[0], list = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n      return indexOf.call(list, item) >= 0;\n    },\n    $returnSerial: function(index) {\n      return index + 1;\n    },\n    $isEmptyArray: function(data) {\n      if (data === 0) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    $getFullName: function(data) {\n      var first, honorifics, last, middle;\n      if (typeof data === \"object\") {\n        honorifics = '';\n        first = '';\n        last = '';\n        middle = '';\n        if (data.honorifics) {\n          honorifics = data.honorifics + \". \";\n        }\n        if (data.first) {\n          first = data.first;\n        }\n        if (data.middle) {\n          middle = \" \" + data.middle;\n        }\n        if (data.last) {\n          last = \" \" + data.last;\n        }\n        return honorifics + first + middle + last;\n      } else {\n        return data;\n      }\n    },\n    $makeNameObject: function(fullName) {\n      var first, honorifics, last, middle, nameObject, namePart, partArray;\n      if (typeof fullName === 'string') {\n        fullName = fullName.trim();\n        partArray = fullName.split('.');\n        namePart = partArray.pop();\n        if (partArray.length === 0) {\n          honorifics = '';\n        } else {\n          honorifics = partArray.join('.').trim();\n        }\n        partArray = (namePart.trim()).split(' ');\n        nameObject = {};\n        if (partArray.length <= 1) {\n          first = partArray[0];\n        } else {\n          first = partArray.shift();\n          last = partArray.pop();\n          middle = partArray.join(' ');\n          if (middle === '') {\n            middle = null;\n          }\n          if (last === '') {\n            last = null;\n          }\n        }\n        if (honorifics === '') {\n          honorifics = null;\n        }\n        nameObject.honorifics = honorifics;\n        nameObject.first = first;\n        nameObject.middle = middle;\n        nameObject.last = last;\n        return nameObject;\n      } else {\n        return fullName;\n      }\n    },\n    $getProfileImage: function(data) {\n      if (data) {\n        return data;\n      } else {\n        return 'images/avatar.png';\n      }\n    },\n    $checkUserAccess: function(accessId) {\n      var currentOrganization, i, len, privilege, privilegeList;\n      currentOrganization = this.getCurrentOrganization();\n      if (accessId === 'none') {\n        return true;\n      } else {\n        if (currentOrganization) {\n          if (currentOrganization.isCurrentUserAnAdmin) {\n            return true;\n          } else if (currentOrganization.isCurrentUserAMember) {\n            if (currentOrganization.userActiveRole) {\n              privilegeList = currentOrganization.userActiveRole.privilegeList;\n              if (privilegeList.length !== 0) {\n                for (i = 0, len = privilegeList.length; i < len; i++) {\n                  privilege = privilegeList[i];\n                  if (privilege.serial === accessId) {\n                    return true;\n                  }\n                }\n              }\n            } else {\n              return true;\n            }\n            return false;\n          } else {\n            return false;\n          }\n        } else {\n          return true;\n        }\n      }\n    }\n  };\n\n}).call(this);\n"]}