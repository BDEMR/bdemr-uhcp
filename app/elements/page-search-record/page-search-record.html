<!-- iron-* --><!-- paper-* --><!-- style --><!-- behavior --><!-- custom-elements --><!-- element --><dom-module id="page-search-record">
  <template>

    <!-- style -->

    <style is="custom-style" include="common-style">
      .limiting-container {
        margin-top: 10px;
      }

      paper-button {
        background: white;
      }

      .results {
        margin-top: 20px;
        padding: 10px;
      }

      .results-top {
        margin-top: 20px;
        text-align: center;
      }

      th {
        border-right: 1px solid #EEEEEE;
        color: #888888;
      }

      .tf {
        font-weight: bold;
      }

      .tr:hover {
        background: #eeeeee;
        cursor: pointer;
      }

      .primary {
        color: white;
        background: #2196F3;
      }

      .search-item {
        margin: 4px;
        padding: 4px;
        background: #ECEFF1;
      }
    </style>

    <!-- local DOM -->

    <div class="master-container">

      <div class="limiting-container vertical layout">

        <!-- search strip - start -->
        <paper-card class="results vertical layout">

          <div class="horizontal layout center">
            <paper-input class="flex" type="date" label="Date Created [From]" value="{{searchParameters.dateCreatedFrom}}" always-float-label=""></paper-input>
            <paper-input class="flex" type="date" label="Date Created [To]" value="{{searchParameters.dateCreatedTo}}" always-float-label=""></paper-input>
            <paper-button class="primary" raised="" on-tap="searchButtonPressed">Search</paper-button>
          </div>

          <div class="horizontal layout search-item">
            <paper-checkbox checked="{{searchParameters.symptoms.shouldSearch}}">Symptoms</paper-checkbox>
            <template is="dom-if" if="[[searchParameters.symptoms.shouldSearch]]">
              <paper-input label="Insert symptom to search" value="{{searchParameters.symptoms.searchString}}"></paper-input>
            </template>
          </div>

          <div class="horizontal layout search-item">
            <paper-checkbox checked="{{searchParameters.diagnosis.shouldSearch}}">Diagnosis</paper-checkbox>
            <template is="dom-if" if="[[searchParameters.diagnosis.shouldSearch]]">
              <paper-input label="Insert symptom to search" value="{{searchParameters.diagnosis.searchString}}"></paper-input>
            </template>
          </div>

        </paper-card>
        <!-- search strip - end -->

        <br>

        <!-- search results - start -->

        <div class="results-top">Found [[matchingRecordList.length]] results</div>

        <paper-card class="results vertical layout">

          <div class="card-content horizontal layout">

            <table>
              <thead>
                <tr>
                  <th>SERIAL</th>
                  <th>DATE CREATED</th>
                  <th>PATIENT SERIAL</th>
                  <th>RECORD TYPE</th>
                </tr>
              </thead>
              <tbody>
                <template is="dom-repeat" items="[[matchingRecordList]]" as="record">
                  <tr class="tr" on-tap="recordPressed">
                    <td>[[record.serial]]</td>
                    <td>[[$mkDate(record.createdDatetimeStamp)]]</td>
                    <td>[[record.patientSerial]]</td>
                    <td>[[record.recordType]]</td>
                  </tr>
                </template>
              </tbody>
            </table>

          </div>
        </paper-card>
        <!-- search results - end -->

      </div>

    </div>

  </template>
  <script>(function(){Polymer({is:"page-search-record",behaviors:[app.behaviors.translating,app.behaviors.pageLike,app.behaviors.apiCalling,app.behaviors.commonComputes,app.behaviors.dbUsing],properties:{matchingRecordList:{type:Array,value:function(){return[]}},searchParameters:{type:Object,value:function(){return{symptoms:{shouldSearch:!1},diagnosis:{shouldSearch:!1}}}}},_loadUser:function(){var r;if(r=app.db.find("user"),1===r.length)return this.user=r[0]},navigatedIn:function(){var r;return r=this.getCurrentOrganization(),r||this.domHost.navigateToPage("#/select-organization"),this._loadUser()},searchButtonPressed:function(r){return this._search()},_goBack:function(){return this.domHost.navigateToPreviousPage()},arrowBackButtonPressed:function(r){return this._goBack()},recordPressed:function(r){var e;return e=r.model.record,this._importAndShowRecord(e)},_searchOnline:function(r,e){var t;return t={apiKey:this.user.apiKey,searchParameters:r,doctorSerial:this.user.serial},this.callApi("/bdemr-doctor-app--search-records",t,function(r){return function(t,i){return i.hasError?r.domHost.showModalDialog(i.error.message):e(i.data.visitList)}}(this))},_search:function(){return this._searchOnline(this.searchParameters,function(r){return function(e){return r.matchingRecordList=e}}(this))},_importAndShowRecord:function(r){var e,t,i;return e="patient-list",i=r.patientSerial,t={apiKey:this.user.apiKey,serial:i,pin:"DISREGARD-ME"},this.callApi("/bdemr-patient-import",t,function(t){return function(a,n){var o,s;return n.hasError?void t.domHost.showModalDialog(n.error.message):(o=n.data[0],app.db.upsert(e,o,function(r){var e;return e=r.serial,o.serial===e}),s="#/visit-preview/visit:"+r.serial+"/patient:"+i,t.domHost._newSync(function(r){return r?t.async(function(){return t.showModalDialog(r)}):t.domHost.navigateToPage(s)}))}}(this))}})}).call(this);
//# sourceMappingURL=page-search-record.coffee-compiled.js.map</script>
</dom-module>