<link rel="import" href="../../bower-assets/polymer/polymer.html">

<!-- paper-* -->
<link rel="import" href="../../bower-assets/paper-card/paper-card.html">
<link rel="import" href="../../bower-assets/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower-assets/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower-assets/paper-item/paper-item.html">
<link rel="import" href="../../bower-assets/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower-assets/paper-progress/paper-progress.html">
<link rel="import" href="../../bower-assets/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../../bower-assets/paper-autocomplete/paper-autocomplete.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid-column.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid-sorter.html">

<link rel="import" href="../custom-vital-search/custom-vital-search.html">
<link rel="import" href="../../bower-assets/vaadin-combo-box/vaadin-combo-box.html">

<!-- style -->
<link rel="import" href="../../styles/common-style.html">

<!-- behavior -->
<link rel="import" href="../../behaviors/translating.html">
<link rel="import" href="../../behaviors/page-like.html">
<link rel="import" href="../../behaviors/api-calling.html">
<link rel="import" href="../../behaviors/common-computes.html">
<link rel="import" href="../../behaviors/db-using.html">

<!-- custom-elements -->

<!-- element -->
<dom-module id="page-invoice-report">
  <template>

    <!-- style -->

    <style is="custom-style" include="common-style">
      .limiting-container {
        margin-top: 10px;
        width: 95%;
      }

      .header {
        background-color: var(--paper-grey-100);
        padding: 15px;
      }

      .label {
        background-color: var(--paper-grey-100);
        padding: 5px;
      }

      paper-progress {
        width: 100%;
        --paper-progress-active-color: var(--paper-orange-500);
      }

      .fixed {
        min-width: 100px;
        text-align: right;
      }

      .paper-custom {
        background-color: #fafafa;
        border: 1px solid #dadada;
        padding: 0px 8px 12px 8px;
        margin: 4px;
        margin-left: 0;
      }
    </style>

    <!-- local DOM -->

    <div class="master-container">

      <div class="limiting-container">

        <!-- Card - Search - start -->
        <paper-card>

          <paper-progress indeterminate hidden$="[[!getBoolean(loadingCounter)]]"></paper-progress>

          <div class="card-content">
            <div class="layout horizontal paper-custom end wrap">

              <!-- <paper-autocomplete id="invoiceSearchInput" label="Search By Investigation" source="[[investigationNameSourceDataList]]"
                  text="{{investigationQuery}}" on-autocomplete-reset-blur="resetInvestigationSearchPressed">
                </paper-autocomplete> -->
              <vaadin-combo-box id="invoiceOrganizationSelector" class="organization-dropdown m-right-8" label="Organization"
                items="[[childOrganizationList]]" on-value-changed="organizationSelected" loading="[[loading]]"
                disabled="[[!childOrganizationList.length]]">
              </vaadin-combo-box>

              <!-- <paper-dropdown-menu label="Filter by Category" class="m-right-8">
                <paper-listbox class="dropdown-content" on-iron-activate="categorySelected">
                  <template is="dom-repeat" items="[[categoryList]]">
                    <paper-item>[[item]]</paper-item>
                  </template>
                </paper-listbox>
              </paper-dropdown-menu> -->

              <paper-input label="EmployeeId/Phone" value="{{employeeIdOrPhone}}" class="m-right-8"></paper-input>
              <paper-input label="Search by Doctor Phone Number" type="number" value="{{doctorPhone}}" class="m-right-8"></paper-input>

              <custom-vital-search class="" on-date-select="filterByDateClicked" on-clear="filterByDateClearButtonClicked"></custom-vital-search>

              <div class="flex"></div>

              <paper-button class="btn btn-primary btn-large" style="margin: 0" on-tap="searchButtonClicked">Search</paper-button>
              <paper-icon-button icon="clear" on-tap="resetButtonClicked">Reset</paper-icon-button>

            </div>

          </div>
          <br>

          <div class="layout horizontal justified p-horizontal-16">
            <h4 class="">Total Invoice: [[matchingInvoiceReportList.length]]</h4>
            <h4 class="">
              <paper-checkbox checked="{{showOnlyDues}}">Show Only Dues</paper-checkbox>
            </h4>
          </div>
          <vaadin-grid items="[[matchingInvoiceReportList]]" id="inoviceListGrid">
            <vaadin-grid-column width="150px" flex-grow="0">
              <template class="header">
                <vaadin-grid-sorter path="serial">Visit Serial</vaadin-grid-sorter>
              </template>
              <template>
                <strong class="label">[[item.visitSerial]]</strong>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column resizable>
              <template class="header">
                <vaadin-grid-sorter path="createdDatetimeStamp" direction="desc">Date</vaadin-grid-sorter>
              </template>
              <template>
                <div>[[$formatDateTime(item.createdDatetimeStamp)]]</div>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column resizable>
              <template class="header">
                <span>Patient Name</span>
              </template>
              <template>
                <div>[[item.patientInfo.name]]</div>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column resizable>
              <template class="header">
                <span>Employee Id</span>
              </template>
              <template>
                <div>[[item.patientInfo.employeeId]]</div>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column>
              <template class="header">
                <span>Total Billed</span>
              </template>
              <template>
                <div>[[$toTwoDecimalPlace(item.totalBilled)]]</div>
              </template>
              <template class="footer">
                <strong>[[$toTwoDecimalPlace(totalInvoiceBilled)]]</strong>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column>
              <template class="header">
                <span>Total Received</span>
              </template>
              <template>
                <div>[[$toTwoDecimalPlace(item.totalAmountReceieved)]]</div>
              </template>
              <template class="footer">
                <strong>[[$toTwoDecimalPlace(totalInvoiceIncome)]]</strong>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column>
              <template class="header">
                <span>Due</span>
              </template>
              <template>
                <div>[[$calculateDue(item.totalBilled, item.totalAmountReceieved)]]</div>
              </template>
              <template class="footer">
                <div>[[$calculateDue(totalInvoiceBilled, totalInvoiceIncome)]]</div>
              </template>
            </vaadin-grid-column>
            <vaadin-grid-column>
              <template class="header">Action
                <span></span>
              </template>
              <template>
                <div>
                  <paper-icon-button icon="launch" on-tap="viewInvoiceButtonPressed"></paper-icon-button>
                </div>
              </template>
            </vaadin-grid-column>
          </vaadin-grid>

      </div>

    </div>

    </div>



  </template>
  <script src="page-invoice-report.coffee-compiled.js"></script>
</dom-module>