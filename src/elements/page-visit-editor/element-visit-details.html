<link rel="import" href="../../behaviors/common-computes.html">
<link rel="import" href="../../behaviors/db-using.html">
<link rel="import" href="../../behaviors/translating.html">
<link rel="import" href="../../behaviors/api-calling.html">

<link rel="import" href="../../bower-assets/iron-icons/iron-icons.html">
<link rel="import" href="../../bower-assets/paper-button/paper-button.html">
<link rel="import" href="../../bower-assets/paper-card/paper-card.html">
<link rel="import" href="../../bower-assets/paper-input/paper-input.html">
<link rel="import" href="../../bower-assets/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower-assets/paper-menu/paper-menu.html">
<link rel="import" href="../../bower-assets/paper-item/paper-item.html">
<link rel="import" href="../../bower-assets/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower-assets/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower-assets/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../../bower-assets/iron-icons/communication-icons.html">

<link rel="import" href="../../styles/common-style.html">
<link rel="import" href="visit-common-styles.html">

<dom-module id="element-visit-details">
  <template>
    <style is="custom-style" include="common-style visit-common-styles">
    </style>

    <div class="card-item-2 horizontal layout wrap center p-8">

      <div class="content left horizontal layout wrap type caption-2">
        <div class="m-4">
          <strong>Record:</strong> [[visit.serial]]</div>
        <div class="m-4">
          <strong>Created Date:</strong> [[$mkDate(visit.createdDatetimeStamp)]]</div>
        <div class="m-4">
          <strong>Created By:</strong> {{visit.doctorName}}</div>
      </div>

      <div class="content right horizontal layout end-justified">
        <paper-button class="btn-add m-vert" on-tap="openVisitSettingsDialog">
          <iron-icon icon="icons:settings"></iron-icon>
        </paper-button>

        <paper-button class="btn-add m-vert" on-tap="printButtonPressed">
          <iron-icon icon="icons:print" class="m-right-8"></iron-icon>Print
        </paper-button>

        <!-- <paper-button raised class="btn-add m-vert" on-tap="openVisitSettingsDialog">
        <iron-icon icon="communication:email"></iron-icon>
      </paper-button> -->

        <paper-button raised class="colored btn-add m-vert" on-tap="finishButtonPressed">
          <iron-icon icon="icons:check" class="m-right-8"></iron-icon>Finish
        </paper-button>

        <paper-button style="background: green !important;" raised class="colored btn-add m-vert" on-tap="makeNewVisitButtonPressed">
          <iron-icon icon="icons:check" class="m-right-8"></iron-icon>New Visit
        </paper-button>


      </div>
    </div>
  </template>
  <script src="mixin-utils.js"></script>
  <script>
    Polymer({
      is: 'element-visit-details',
      behaviors: [
        app.behaviors.commonComputes,
        app.behaviors.dbUsing,
        app.behaviors.translating,
        app.behaviors.apiCalling,
        app.behaviors.local.visitUtilsMixin
      ],
      properties: {
        patient: Object,
        user: Object,
        visit: {
          type: Object,
          observer: 'visitValueChanged'
        },
        organization: {
          type: Object
        }
      },

      attached: function () {

      },

      detached: function () {

      },

      visitValueChanged: function (visit) {

        if (!visit.serial) {
        }
        if (visit.serial) {

        }
      },

      makeNewVisitButtonPressed: function () {
        this.domHost.domHost.setSelectedVisitSerial('new')
      },

      printButtonPressed: function (e) {
        this.set('addedExaminationList2', []);
        this.printPrescriptionOnly = this.checkForPrintPreviewType();
        // hack for addedExamination List not updated on print preview
        lib.util.delay(200, () => {
          this.set('addedExaminationList2', this.addedExaminationList);
          lib.util.delay(200, () => {
            console.log('addedExaminationList2', this.addedExaminationList2);
            window.print();
          });
        });
      }



    });
  </script>
</dom-module>